---
{"dg-publish":true,"permalink":"/01.后端技术学习/并发/生产级别 Tomcat 配置推荐/"}
---

```yaml
server:
  port: 9000 
tomcat:
  uri-encoding: UTF-8 
  max-threads: 800 #最大工作线程数量 
  min-spare-threads: 20 #最小工作线程数量 
  max-connections: 10000 #一瞬间最大支持的并发的连接数 
  accept-count: 200 #等待队列长度
```
- 线程数的经验值为：4 核 8G 内存，线程数经验值 800。 （4 核 8G 内存单进程调度线程数 800-1000，超过这个并发数之后，将会花费巨大的时间在 CPU 调度上）  
- 等待队列长度：队列做缓冲池用，但也不能无限长，消耗内存，出入队列也耗 CPU。  
- maxThreads 规定的是最大的线程数目，并不是实际 running 的 CPU 数量；实际上，maxThreads 的大小比 CPU 核心数量要大得多。这是因为，处理请求的线程真正用于计算的时间可能很少，大多数时间可能在阻塞，如等待数据库返回数据、等待硬盘读写数据等。因此，在某一时刻，只有少数的线程真正的在使用物理 CPU，大多数线程都在等待；因此线程数远大于物理核心数才是合理的。也就是说，Tomcat 通过使用比 CPU 核心数量多得多的线程数，可以使 CPU 忙碌起来，大大提高 CPU 的利用率。  

若有收获，就点个赞吧